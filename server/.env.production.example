# =============================================================================
# PRODUCTION SECURITY CONFIGURATION
# CareTrack Pro - Healthcare-Grade Security Environment Variables
# =============================================================================

# CRITICAL: Generate strong, unique values for production deployment
# Use: openssl rand -hex 32

# =============================================================================
# CORE SECURITY CONFIGURATION
# =============================================================================

# JWT Configuration (CRITICAL - Must be 64+ characters)
JWT_SECRET="REPLACE_WITH_STRONG_64_CHARACTER_SECRET_FROM_OPENSSL_RAND"
JWT_EXPIRES_IN="8h"
JWT_REFRESH_EXPIRES_IN="7d"

# Session Security (CRITICAL - Must be 64+ characters)
SESSION_SECRET="REPLACE_WITH_STRONG_64_CHARACTER_SECRET_FROM_OPENSSL_RAND"
SESSION_TIMEOUT=1800000  # 30 minutes for HIPAA compliance

# Encryption Keys (CRITICAL - Must be 64+ characters each)
PHI_ENCRYPTION_KEY="REPLACE_WITH_STRONG_64_CHARACTER_KEY_FOR_PHI_ENCRYPTION"
DATA_AT_REST_KEY="REPLACE_WITH_STRONG_64_CHARACTER_KEY_FOR_DATA_ENCRYPTION"

# Password Security
BCRYPT_ROUNDS=14  # Minimum 12 for healthcare, 14 recommended
ENFORCE_STRONG_PASSWORDS=true

# =============================================================================
# DATABASE SECURITY
# =============================================================================

# Primary Database (Use connection pooling parameters)
DATABASE_URL="postgresql://username:STRONG_PASSWORD@hostname:5432/caretrack_pro?schema=public&connection_limit=20&pool_timeout=30&connect_timeout=10&sslmode=require"

# Database Connection Security
DB_CONNECTION_LIMIT=20
DB_ACQUIRE_TIMEOUT=60000
DB_TIMEOUT=30000
DB_SSL_ENABLED=true
DB_SSL_REJECT_UNAUTHORIZED=true
CONNECTION_POOLING_ENABLED=true

# Database Performance & Security
SLOW_QUERY_THRESHOLD=1000
DB_QUERY_TIMEOUT=30000
PERFORMANCE_MONITORING_ENABLED=true
HEALTH_CHECK_INTERVAL=30000

# =============================================================================
# HIPAA COMPLIANCE CONFIGURATION
# =============================================================================

# Data Retention (7 years = 2555 days)
DATA_RETENTION_DAYS=2555
HIPAA_DATA_RETENTION_YEARS=7

# PHI Protection
PHI_ENCRYPTION_ENABLED=true
HIPAA_COMPLIANCE_ENABLED=true
DATA_ANONYMIZATION_ENABLED=true
MINIMUM_NECESSARY_ACCESS=true

# Auto-logoff (HIPAA requirement - 30 minutes max)
HIPAA_AUTO_LOGOFF_MINUTES=30
AUTO_LOGOUT_TIMEOUT=1800000

# Breach Notification
HIPAA_BREACH_EMAIL="security@yourdomain.com"
HIPAA_BA_MODE=true  # Business Associate mode

# Audit Requirements
AUDIT_LOGGING_ENABLED=true
AUDIT_LOG_LEVEL="info"
AUDIT_RETENTION_DAYS=2555  # 7 years
AUDIT_LOG_TO_DATABASE=true
AUDIT_LOG_TO_SIEM=true

# =============================================================================
# NETWORK SECURITY
# =============================================================================

# Rate Limiting (Aggressive for production)
RATE_LIMIT_WINDOW_MS=900000     # 15 minutes
RATE_LIMIT_MAX_REQUESTS=500     # Conservative limit
RATE_LIMIT_AUTH_MAX=3           # Very restrictive for auth

# CSRF Protection
CSRF_PROTECTION_ENABLED=true

# CORS Configuration (Restrict to specific domains)
FRONTEND_URL="https://yourdomain.com"
API_BASE_URL="https://api.yourdomain.com"

# Security Headers
SECURE_HEADERS_ENABLED=true
HSTS_MAX_AGE=31536000  # 1 year
HSTS_INCLUDE_SUBDOMAINS=true

# =============================================================================
# FILE UPLOAD SECURITY
# =============================================================================

MAX_FILE_SIZE_MB=10
UPLOAD_DIR="/secure/uploads"
MALWARE_SCANNING_ENABLED=true
FILE_TYPE_VALIDATION_ENABLED=true

# Allowed file types (restrictive list)
ALLOWED_MIME_TYPES="application/pdf,image/jpeg,image/png,text/plain,text/csv"
ALLOWED_EXTENSIONS=".pdf,.jpg,.jpeg,.png,.txt,.csv"

# =============================================================================
# MONITORING AND ALERTING
# =============================================================================

# Security Monitoring
MONITORING_ENABLED=true
SECURITY_MONITORING_ENABLED=true

# Performance Thresholds
PERFORMANCE_THRESHOLD_MS=2000
ERROR_THRESHOLD_COUNT=10
ERROR_THRESHOLD_WINDOW=60000
MEMORY_THRESHOLD_PERCENT=85
CPU_THRESHOLD_PERCENT=80

# Alert Configuration
ALERT_EMAIL="security@yourdomain.com"
SECURITY_ALERT_EMAIL="security@yourdomain.com"
SECURITY_ALERT_SMS="+1234567890"
SLACK_WEBHOOK_URL="https://hooks.slack.com/your-webhook-url"

# SIEM Integration
SECURITY_WEBHOOK_URL="https://your-siem-system.com/webhook"
SIEM_API_KEY="your-siem-api-key"

# =============================================================================
# EMAIL SECURITY
# =============================================================================

# Email Service (Use secure SMTP with TLS)
EMAIL_SERVICE="smtp"
SMTP_HOST="smtp.yourdomain.com"
SMTP_PORT=587  # Use 587 for STARTTLS
SMTP_USER="noreply@yourdomain.com"
SMTP_PASS="STRONG_EMAIL_PASSWORD"
SMTP_FROM="CareTrack Pro Security <noreply@yourdomain.com>"

# Email Security
SMTP_SECURE=true
SMTP_TLS_ENABLED=true
SMTP_TLS_REJECT_UNAUTHORIZED=true

# =============================================================================
# BACKUP AND RECOVERY
# =============================================================================

# Database Backup
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM
BACKUP_RETENTION_DAYS=90
BACKUP_STORAGE_PATH="/secure/backups"
BACKUP_ENCRYPTION_ENABLED=true
BACKUP_ENCRYPTION_KEY="REPLACE_WITH_BACKUP_ENCRYPTION_KEY"

# Disaster Recovery
DR_ENABLED=true
DR_RTO_HOURS=4   # Recovery Time Objective
DR_RPO_HOURS=1   # Recovery Point Objective

# =============================================================================
# SERVER CONFIGURATION
# =============================================================================

NODE_ENV="production"
PORT=3001

# Logging Configuration
LOG_LEVEL="warn"  # Less verbose in production
LOG_TO_FILE="true"
LOG_FILE_PATH="/var/log/caretrack/app.log"
LOG_ROTATION_ENABLED=true
LOG_MAX_SIZE="10MB"
LOG_MAX_FILES=10

# Process Management
PM2_INSTANCES=4  # Number of PM2 instances
CLUSTER_MODE=true

# =============================================================================
# THIRD-PARTY INTEGRATIONS
# =============================================================================

# API Keys (Use separate keys for production)
SENDGRID_API_KEY="your-sendgrid-production-key"
STRIPE_SECRET_KEY="sk_live_your-stripe-key"

# OAuth Configuration (if applicable)
OAUTH_CLIENT_ID="your-oauth-client-id"
OAUTH_CLIENT_SECRET="your-oauth-client-secret"

# Medical Device Integration (if applicable)
MEDICAL_DEVICE_API_KEY="your-medical-device-api-key"
MEDICAL_DEVICE_ENDPOINT="https://secure-medical-api.com"

# =============================================================================
# COMPLIANCE AND AUDIT
# =============================================================================

# Compliance Officer Contact
COMPLIANCE_OFFICER_EMAIL="compliance@yourdomain.com"
COMPLIANCE_OFFICER_PHONE="+1234567890"

# Audit Configuration
EXTERNAL_AUDIT_ENABLED=true
AUDIT_FIRM_CONTACT="audit@auditfirm.com"

# Business Associate Agreement
BAA_SIGNED=true
BAA_EXPIRY_DATE="2025-12-31"

# =============================================================================
# SECURITY TESTING
# =============================================================================

# Penetration Testing
PENTEST_ENABLED=true
PENTEST_SCHEDULE="quarterly"
PENTEST_FIRM_CONTACT="pentest@securityfirm.com"

# Vulnerability Scanning
VULN_SCAN_ENABLED=true
VULN_SCAN_SCHEDULE="weekly"

# =============================================================================
# DEPLOYMENT CONFIGURATION
# =============================================================================

# Infrastructure
DEPLOYMENT_ENV="production"
LOAD_BALANCER_ENABLED=true
CDN_ENABLED=true
WAF_ENABLED=true

# SSL/TLS Configuration
SSL_ENABLED=true
SSL_CERT_PATH="/path/to/ssl/cert.pem"
SSL_KEY_PATH="/path/to/ssl/private.key"
SSL_CA_PATH="/path/to/ssl/ca-bundle.pem"

# Container Security (if using Docker)
CONTAINER_SECURITY_ENABLED=true
CONTAINER_SCAN_ENABLED=true
RUNTIME_SECURITY_ENABLED=true

# =============================================================================
# EMERGENCY CONTACTS
# =============================================================================

# Emergency Response Team
SECURITY_TEAM_EMAIL="security-emergency@yourdomain.com"
SECURITY_TEAM_PHONE="+1-800-SECURITY"
ON_CALL_ENGINEER="+1234567890"

# Vendor Contacts
HOSTING_PROVIDER_SUPPORT="+1-800-HOSTING"
DATABASE_VENDOR_SUPPORT="+1-800-DATABASE"
SECURITY_VENDOR_SUPPORT="+1-800-SECURITY-VENDOR"

# =============================================================================
# NOTES FOR PRODUCTION DEPLOYMENT
# =============================================================================

# IMPORTANT SECURITY CHECKLIST:
# 
# 1. GENERATE NEW SECRETS:
#    - Run: openssl rand -hex 32 for each secret
#    - Never reuse development secrets in production
#
# 2. DATABASE SECURITY:
#    - Use strong database passwords (20+ characters)
#    - Enable SSL connections (sslmode=require)
#    - Configure IP whitelisting
#    - Enable database audit logging
#
# 3. NETWORK SECURITY:
#    - Configure WAF (Web Application Firewall)
#    - Enable DDoS protection
#    - Use CDN for static assets
#    - Configure rate limiting at infrastructure level
#
# 4. SERVER SECURITY:
#    - Run server as non-root user
#    - Configure firewall (only open required ports)
#    - Enable fail2ban or similar intrusion prevention
#    - Keep OS and dependencies updated
#
# 5. MONITORING:
#    - Configure application performance monitoring
#    - Set up security information and event management (SIEM)
#    - Enable real-time alerting
#    - Configure log aggregation and analysis
#
# 6. BACKUP AND RECOVERY:
#    - Test backup restoration procedures
#    - Encrypt all backups
#    - Store backups in separate geographic location
#    - Document recovery procedures
#
# 7. COMPLIANCE:
#    - Conduct regular security assessments
#    - Maintain audit documentation
#    - Train staff on security procedures
#    - Review and update security policies
#
# 8. INCIDENT RESPONSE:
#    - Develop incident response plan
#    - Test incident response procedures
#    - Maintain emergency contact list
#    - Document lessons learned